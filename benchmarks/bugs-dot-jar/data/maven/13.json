{
    "bug_id": 13,
    "classification": {
        "singleLine": false
    },
    "commit": "06090da4",
    "failing_tests": [
        "org.apache.maven.artifact.repository.metadata.AbstractRepositoryMetadataTest"
    ],
    "files": 2,
    "jira_id": "2712",
    "linesAdd": 3,
    "linesRem": 3,
    "nb_error": 0,
    "nb_failure": 2,
    "nb_skipped": 0,
    "nb_test": 13,
    "patch": "diff --git a/maven-artifact-manager/src/main/java/org/apache/maven/artifact/repository/metadata/AbstractRepositoryMetadata.java b/maven-artifact-manager/src/main/java/org/apache/maven/artifact/repository/metadata/AbstractRepositoryMetadata.java\nindex 603dfea08..d5a6460a6 100644\n--- a/maven-artifact-manager/src/main/java/org/apache/maven/artifact/repository/metadata/AbstractRepositoryMetadata.java\n+++ b/maven-artifact-manager/src/main/java/org/apache/maven/artifact/repository/metadata/AbstractRepositoryMetadata.java\n@@ -119,10 +119,10 @@ protected void updateRepositoryMetadata( ArtifactRepository localRepository, Art\n         if ( version != null && ( Artifact.LATEST_VERSION.equals( version ) || Artifact.RELEASE_VERSION.equals( version ) ) )\n         {\n             // meta-versions are not valid <version/> values...don't write them.\n-            changed = false;\n+            metadata.setVersion( null );\n         }\n \n-        if ( changed )\n+        if ( changed || !metadataFile.exists() )\n         {\n             Writer writer = null;\n             try\ndiff --git a/maven-artifact-manager/src/main/java/org/apache/maven/artifact/repository/metadata/DefaultRepositoryMetadataManager.java b/maven-artifact-manager/src/main/java/org/apache/maven/artifact/repository/metadata/DefaultRepositoryMetadataManager.java\nindex c82d60739..ddc23c08d 100644\n--- a/maven-artifact-manager/src/main/java/org/apache/maven/artifact/repository/metadata/DefaultRepositoryMetadataManager.java\n+++ b/maven-artifact-manager/src/main/java/org/apache/maven/artifact/repository/metadata/DefaultRepositoryMetadataManager.java\n@@ -106,7 +108,7 @@ else if ( repository.isBlacklisted() )\n                     {\n                         file.setLastModified( System.currentTimeMillis() );\n                     }\n-                    else if ( !metadataIsEmpty )\n+                    else\n                     {\n                         // this ensures that files are not continuously checked when they don't exist remotely\n                         try\n",
    "project": "maven"
}