{
    "bug_id": 21,
    "classification": {
        "singleLine": false
    },
    "commit": "faa5cf27",
    "failing_tests": [
        "org.apache.maven.project.inheritance.DefaultModelInheritanceAssemblerTest"
    ],
    "files": 1,
    "jira_id": "1856",
    "linesAdd": 26,
    "linesRem": 64,
    "nb_error": 0,
    "nb_failure": 1,
    "nb_skipped": 0,
    "nb_test": 80,
    "patch": "diff --git a/maven-project/src/main/java/org/apache/maven/project/inheritance/DefaultModelInheritanceAssembler.java b/maven-project/src/main/java/org/apache/maven/project/inheritance/DefaultModelInheritanceAssembler.java\nindex 2839c50f4..1d2268fb0 100644\n--- a/maven-project/src/main/java/org/apache/maven/project/inheritance/DefaultModelInheritanceAssembler.java\n+++ b/maven-project/src/main/java/org/apache/maven/project/inheritance/DefaultModelInheritanceAssembler.java\n@@ -107,10 +107,6 @@ private void assembleModelInheritance( Model child, Model parent, String childPa\n             }\n         }\n \n-        // ----------------------------------------------------------------------\n-        // Distribution\n-        // ----------------------------------------------------------------------\n-\n         assembleDistributionInheritence( child, parent, childPathAdjustment, appendPaths );\n \n         // issueManagement\n@@ -177,8 +173,6 @@ private void assembleModelInheritance( Model child, Model parent, String childPa\n \n         assembleDependencyManagementInheritance( child, parent );\n \n-        assembleDistributionManagementInheritance( child, parent );\n-\n         Properties props = new Properties();\n         props.putAll( parent.getProperties() );\n         props.putAll( child.getProperties() );\n@@ -186,46 +180,6 @@ private void assembleModelInheritance( Model child, Model parent, String childPa\n         child.setProperties( props );\n     }\n \n-    private void assembleDistributionManagementInheritance( Model child, Model parent )\n-    {\n-        DistributionManagement cDistMgmt = child.getDistributionManagement();\n-        DistributionManagement pDistMgmt = parent.getDistributionManagement();\n-\n-        if ( cDistMgmt == null )\n-        {\n-            child.setDistributionManagement( pDistMgmt );\n-        }\n-        else if ( pDistMgmt != null )\n-        {\n-            if ( cDistMgmt.getRepository() == null )\n-            {\n-                cDistMgmt.setRepository( pDistMgmt.getRepository() );\n-            }\n-\n-            if ( cDistMgmt.getSnapshotRepository() == null )\n-            {\n-                cDistMgmt.setSnapshotRepository( pDistMgmt.getSnapshotRepository() );\n-            }\n-\n-            if ( StringUtils.isEmpty( cDistMgmt.getDownloadUrl() ) )\n-            {\n-                cDistMgmt.setDownloadUrl( pDistMgmt.getDownloadUrl() );\n-            }\n-\n-            if ( cDistMgmt.getRelocation() == null )\n-            {\n-                cDistMgmt.setRelocation( pDistMgmt.getRelocation() );\n-            }\n-\n-            if ( cDistMgmt.getSite() == null )\n-            {\n-                cDistMgmt.setSite( pDistMgmt.getSite() );\n-            }\n-\n-            // NOTE: We SHOULD NOT be inheriting status, since this is an assessment of the POM quality.\n-        }\n-    }\n-\n     private void assembleDependencyManagementInheritance( Model child, Model parent )\n     {\n         DependencyManagement parentDepMgmt = parent.getDependencyManagement();\n@@ -486,38 +440,46 @@ private void assembleDistributionInheritence( Model child, Model parent, String\n             {\n                 if ( parentDistMgmt.getRepository() != null )\n                 {\n-                    DeploymentRepository repository = new DeploymentRepository();\n-\n+                    DeploymentRepository repository = copyDistributionRepository( parentDistMgmt.getRepository() );\n                     childDistMgmt.setRepository( repository );\n-\n-                    repository.setId( parentDistMgmt.getRepository().getId() );\n-\n-                    repository.setName( parentDistMgmt.getRepository().getName() );\n-\n-                    repository.setUrl( parentDistMgmt.getRepository().getUrl() );\n-\n-                    repository.setUniqueVersion( parentDistMgmt.getRepository().isUniqueVersion() );\n                 }\n             }\n \n             if ( childDistMgmt.getSnapshotRepository() == null )\n             {\n                 if ( parentDistMgmt.getSnapshotRepository() != null )\n+                {\n+                    DeploymentRepository repository =\n+                        copyDistributionRepository( parentDistMgmt.getSnapshotRepository() );\n+                    childDistMgmt.setSnapshotRepository( repository );\n+                }\n+            }\n+\n+            if ( StringUtils.isEmpty( childDistMgmt.getDownloadUrl() ) )\n+            {\n+                childDistMgmt.setDownloadUrl( parentDistMgmt.getDownloadUrl() );\n+            }\n+\n+            // NOTE: We SHOULD NOT be inheriting status, since this is an assessment of the POM quality.\n+            // NOTE: We SHOULD NOT be inheriting relocation, since this relates to a single POM\n+        }\n+    }\n+\n+    private static DeploymentRepository copyDistributionRepository( DeploymentRepository parentRepository )\n     {\n         DeploymentRepository repository = new DeploymentRepository();\n \n-                    childDistMgmt.setSnapshotRepository( repository );\n+        repository.setId( parentRepository.getId() );\n \n-                    repository.setId( parentDistMgmt.getSnapshotRepository().getId() );\n+        repository.setName( parentRepository.getName() );\n \n-                    repository.setName( parentDistMgmt.getSnapshotRepository().getName() );\n+        repository.setUrl( parentRepository.getUrl() );\n \n-                    repository.setUrl( parentDistMgmt.getSnapshotRepository().getUrl() );\n+        repository.setLayout( parentRepository.getLayout() );\n \n-                    repository.setUniqueVersion( parentDistMgmt.getSnapshotRepository().isUniqueVersion() );\n-                }\n-            }\n-        }\n+        repository.setUniqueVersion( parentRepository.isUniqueVersion() );\n+\n+        return repository;\n     }\n \n     protected String appendPath( String parentPath, String childPath, String pathAdjustment, boolean appendPaths )\n",
    "project": "maven"
}